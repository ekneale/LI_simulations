#include "TGraph.h"
#include "myStyle.C"

void PlotProperties(){

  // Set plot style
  TStyle *myStyle = GetmyStyle();
  gROOT->SetStyle("myStyle");
  gROOT->ForceStyle();  

  double energy_water[60] = {
    1.56962e-09, 1.58974e-09, 1.61039e-09, 1.63157e-09,
    1.65333e-09, 1.67567e-09, 1.69863e-09, 1.72222e-09,
    1.74647e-09, 1.77142e-09, 1.7971e-09, 1.82352e-09,
    1.85074e-09, 1.87878e-09, 1.90769e-09, 1.93749e-09,
    1.96825e-09, 1.99999e-09, 2.03278e-09, 2.06666e-09,
    2.10169e-09, 2.13793e-09, 2.17543e-09, 2.21428e-09,
    2.25454e-09, 2.29629e-09, 2.33962e-09, 2.38461e-09,
    2.43137e-09, 2.47999e-09, 2.53061e-09, 2.58333e-09,
    2.63829e-09, 2.69565e-09, 2.75555e-09, 2.81817e-09,
    2.88371e-09, 2.95237e-09, 3.02438e-09, 3.09999e-09,
    3.17948e-09, 3.26315e-09, 3.35134e-09, 3.44444e-09,
    3.54285e-09, 3.64705e-09, 3.75757e-09, 3.87499e-09,
    3.99999e-09, 4.13332e-09, 4.27585e-09, 4.42856e-09,
    4.59258e-09, 4.76922e-09, 4.95999e-09, 5.16665e-09,
    5.39129e-09, 5.63635e-09, 5.90475e-09, 6.19998e-09 };

  double absorption[60] = {
    16.1419, 18.278, 21.0657, 24.8568, 30.3117,
    38.8341, 54.0231, 81.2306, 120.909, 160.238,
    193.771, 215.017, 227.747, 243.85, 294.036,
    321.647, 342.81, 362.827, 378.041, 449.378,
    739.434, 1114.23, 1435.56, 1611.06, 1764.18,
    2100.95, 2292.9, 2431.33, 3053.6, 4838.23,
    6539.65, 7682.63, 9137.28, 12220.9, 15270.7,
    19051.5, 23671.3, 29191.1, 35567.9, 42583,
    49779.6, 56465.3, 61830, 65174.6, 66143.7,
    64820, 61635, 57176.2, 52012.1, 46595.7,
    41242.1, 36146.3, 31415.4, 27097.8, 23205.7,
    19730.3, 16651.6, 13943.6, 11578.1, 9526.13};

  double rayleigh[60] = {
    386929, 366249, 346398, 327355, 309097,
    291603, 274853, 258825, 243500, 228856,
    214873, 201533, 188816, 176702, 165173,
    154210, 143795, 133910, 124537, 115659,
    107258, 99318.2, 91822.2, 84754, 78097.3,
    71836.5, 65956, 60440.6, 55275.4, 50445.6,
    45937, 41735.2, 37826.6, 34197.6, 30834.9,
    27725.4, 24856.6, 22215.9, 19791.3, 17570.9,
    15543, 13696.6, 12020.5, 10504.1, 9137.15,
    7909.45, 6811.3, 5833.25, 4966.2, 4201.36,
    3530.28, 2944.84, 2437.28, 2000.18, 1626.5,
    1309.55, 1043.03, 821.016, 637.97, 488.754};

  double pp_reflectivity[33] = {
    2.06642,
    2.10144, 2.13768, 2.17518, 2.21402, 2.25428,
    2.29602, 2.33934, 2.38433, 2.43108, 2.4797,
    2.53031, 2.58302, 2.63798, 2.69533, 2.75523,
    2.81784, 2.88338, 2.95203, 3.02403, 3.09963,
    3.17911, 3.26277, 3.35095, 3.44403, 3.54243,
    3.64662, 3.75713, 3.87454, 3.99952, 4.13284,
    4.27535, 4.42804};

  double reflectivity[33] = {
    0.97,
    0.97, 0.97, 0.97, 0.97, 0.97,
    0.97, 0.97, 0.97, 0.97, 0.97,
    0.97, 0.97, 0.97, 0.97, 0.97,
    0.97, 0.97, 0.97, 0.97, 0.97,
    0.96, 0.96, 0.95, 0.95, 0.95,
    0.94, 0.93, 0.92, 0.91, 0.90,
    0.89, 0.86};

  double abwff = 1.30;
  double rayff = 0.75;
  double refff = 0.90/0.97;

  for (auto i=0;i<sizeof(energy_water); i++){
    rayleigh[i] = rayleigh[i]*rayff;
    absorption[i] = absorption[i]*abwff;
    energy_water[i] = energy_water[i]*10e9;

  }
  for (auto i=0;i<sizeof(pp_reflectivity); i++){
    reflectivity[i] = reflectivity[i]*refff;
  }

  TGraph *tgAbs = new TGraph(sizeof(energy_water),energy_water,absorption);
  TGraph *tgRay = new TGraph(sizeof(energy_water),energy_water,rayleigh);
  TGraph *tgRef = new TGraph(sizeof(pp_reflectivity),pp_reflectivity,reflectivity);

  tgAbs->SetLineWidth(2);
  tgAbs->GetXaxis()->SetTitle("Energy (eV)");
  tgAbs->GetYaxis()->SetTitle("Attenuation length (cm)");
  tgAbs->Draw();

  tgRay->SetLineWidth(2);
  tgRay->GetXaxis()->SetTitle("Energy (eV)");
  tgRay->GetYaxis()->SetTitle("Scattering length (cm)");
  tgRay->Draw();

  tgRef->SetLineWidth(2);
  tgRef->GetXaxis()->SetTitle("Energy (eV)");
  tgRef->GetYaxis()->SetTitle("Reflectivity");
  tgRef->Draw();


}


